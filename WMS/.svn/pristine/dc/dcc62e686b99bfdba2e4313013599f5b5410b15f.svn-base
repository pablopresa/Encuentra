package aTest;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Hashtable;
import java.util.List;

import beans.bulto;
import beans.bultoContenido;
import logica.Logica;

public class CrearBultos {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		List<String> codigosArticulos = new ArrayList<String>(Arrays.asList("0AM4084P05340","0J84934CSK070","0000124947350","0000124947360","0000124947370","0000124947380","0000124947390","0000124947400")); //,"0000124VN0350","0000124VN0360","0000124VN0370","0000124VN0380","0000124VN0390","0000124VN0400","0000200000000","0000201000000","0000274910400","0000274910410","0000274910420","0000274910430","0000274910440","0000274910450","0000274910460","0000300000000","0000327BL0105","0000327BL0850","0000327BL0950","0000327MA0105","0000327MA0850","0000327MA0950","0000400000000","0000425500400","0000425500410","0000425500420","0000425500430","0000425500440","0000425500450","0000425500460","0000441880400","0000441880410","0000441880420","0000441880430","0000441880440","0000441880450","0000441880460","0000490999000","0000500000000","0000502220360","0000502220370","0000502220380","0000502220390","0000502220400","0000502220410","0000504910360","0000504910370","0000504910380","0000504910390","0000504910400","0000504910410","00005091M0085","00005091M0090","00005091M0095","00005091M0105","0000509MA0085","0000509MA0090","0000509MA0095","0000509MA0105","0000509VE0085","0000509VE0090","0000509VE0095","0000509VE0105","00005101M0085","00005101M0095","00005101M0105","0000510MA0085","0000510MA0095","0000510MA0105","0000510VE0085","0000510VE0095","0000510VE0105","0000513500000","0000513MA0000","0000517500085","0000517500095","0000517500105","0000517MA0085","0000517MA0095","0000517MA0105","0000520BL0085","0000520BL0095","0000520BL0105","0000520MA0085","0000520MA0095","0000520MA0105","0000521NE0085","0000521NE0095","0000521NE0105","0000521NR0085","0000521NR0095","0000521NR0105","0000530260085","0000530260095","0000530260105","0000531NE0085","0000531NE0095","0000531NE0105","0000563FU0085","0000563FU0095","0000563FU0105","0000563MA0085","0000563MA0095","0000563MA0105","0000563PL0085","0000563PL0095","0000563PL0105","0000563VE0085","0000563VE0095","0000563VE0105","0000600000000","0000622MA0090","0000622MA0095","0000622MA0105","0000623MA0090","0000623MA0095","0000624MA0095","0000624MA0105","0000700000000","0000800000000","0000813947350","0000813947360","0000813947370","0000813947380","0000813947390","0000813947400","0000813W60350","0000813W60360","0000813W60370","0000813W60380","0000813W60390","0000813W60400","0000900000000","0000901111360","0000901111370","0000901111380","0000901111390","0000901111400","0000901111410","0000901645360","0000901645370","0000901645380","0000901645390","0000901645400","0000901645410","0000931010360","0000931010370","0000931010380","0000931010390","0000931010400","0000931010410","0000931111360","0000931111370","0000931111380","0000931111390","0000931111400","0000931111410","0000931540360","0000931540370","0000931540380","0000931540390","0000931540400","0000931540410","0000931645360","0000931645370","0000931645380","0000931645390","0000931645400","0000931645410","0000H10170090","0000H10170100","0000H10170110","0000H10170120","0000H10MA0090","0000H10MA0100","0000H10MA0110","0000H10MA0120","0000H10MAO090","0000H10MAO100","0000H10MAO110","0000H10MAO120","0000H11170090","0000H11170100","0000H11170110","0000H11170120","0000H11MA0090","0000H11MA0100","0000H11MA0110","0000H11MA0120","0000H12170090","0000H12170100","0000H12170110","0000H12170120","0000H12MA0090","0000H12MA0100","0000H12MA0110","0000H12MA0120","0001000410080","0001000410090","0001000410100","0001000410110","0001000410120","0001000410130","0001004033070","0001004033080","0001004033090","0001004033100","0001004033110","0001004041070","0001004041080","0001004041090","0001004041100","0001004041110","0001013150350","0001013150360","0001013150370","0001013150380","0001013150390","0001013150400","0001013800350","0001013800360","0001013800370","0001013800380","0001013800390","0001013800400","000101WCY200L","000101WCY200M","000101WCY200S","000101WCY20XL","000101WSHG00L","000101WSHG00M","000101WSHG00S","000101WSHG0XL","0001024KSO350","0001024KSO360","0001024KSO370","0001024KSO380","0001024KSO390","0001024KSO400","0001024KSP350","0001024KSP360","0001024KSP370","0001024KSP380","0001024KSP390","0001024KSP400","0001026140350","0001026140360","0001026140370","0001026140380","0001026140390","0001026140400","0001026VTY350","0001026VTY360","0001026VTY370","0001026VTY380","0001026VTY390","0001026VTY400","0001037947350","0001037947360","0001037947370","0001037947380","0001037947390","0001037947400","0001037KAU350","0001037KAU360","0001037KAU370","0001037KAU380","0001037KAU390","0001037KAU400","0001037OR0350","0001037OR0360","0001037OR0370","0001037OR0380","0001037OR0390","0001037OR0400","0001043CY2350","0001043CY2360","0001043CY2370","0001043CY2380","0001043CY2390","0001043CY2400","0001060110000","0001060500000","0001060550000","0001100990080","0001100990090","0001100990100","0001100990110","0001100990120","0001100990130","0001101CK82-4","0001101CK84-6","0001101CK86-8","0001101CK88-1","0001104I6500L","0001104I6500M","0001104I6500S","0001104I650XL","0001104LFX00L","0001104LFX00M","0001104LFX00S","0001104LFX0XL","0001104LFY00L","0001104LFY00M","0001104LFY00S","0001104LFY0XL","0001108CK82-4","0001108CK84-6","0001108CK86-8","0001108CK88-1","0001115041070","0001115041080","0001115041090","0001115041100","0001115041110","0001115041120","0001115645070","0001115645080","0001115645090","0001115645100","0001115645110","0001115645120","0001116BL0000","0001117BL0000","0001126211350","0001126211360","0001126211370","0001126211380","0001126211390","0001126211400","00011313252-4","00011313254-6","00011313256-8","00011313258-1","0001131CK82-4","0001131CK84-6","0001131CK86-8","0001131CK88-1","0001141291070","0001141291080","0001141291090","0001141291100","0001141291110","0001141292070","0001141292080","0001141292090","0001141292100","0001141292110","0001141293070","0001141293080","0001141293090","0001141293100","0001141293110","00011433252-4","00011433254-6","00011433256-8","00011433258-1","0001143CK82-4","0001143CK84-6","0001143CK86-8","0001143CK88-1","0001143N452-4","0001143N454-6","0001143N456-8","0001143N458-1","0001144WP1260","0001144WP1270","0001144WP1280","0001144WP1290","0001145FS2150","0001145FS2160","0001145FS2170","0001145FS2180","0001145FS2190","0001146325260","0001146325270","0001146325280","0001146325290","0001148C87170","0001148C87180","0001148C87190","0001148C87200","0001148C87210","0001151325190","0001151325200","0001151325210","0001151325220","0001151325230","0001151325240","0001151325250","0001152670260","0001152670270","0001152670280","0001152670290","0001152DK1260","0001152DK1270","0001152DK1280","0001152DK1290","0001153260260","0001153260270","0001153260280","0001153260290","0001154260300","0001154260310","0001154260320","0001154260330","0001154260340","0001155670190","0001155670200","0001155670210","0001155670220","0001155670230","0001155670240","0001155670250","0001155DK1190","0001155DK1200","0001155DK1210","0001155DK1220","0001155DK1230","0001155DK1240","0001155DK1250","0001156260190","0001156260200","0001156260210","0001156260220","0001156260230","0001156260240","0001156260250","0001159UUY300","0001159UUY310","0001159UUY320","0001159UUY330","0001159UUY340","0001160966000","0001160N45000","0001165C87150","0001165C87160","0001165C87170","0001165C87180","0001165C87190","0001165C87200","0001165C87210","0001166ABA260","0001166ABA270","0001166ABA280","0001166ABA290","0001169966000","0001175BK0070","0001175BK0080","0001175BK0090","0001175BK0100","0001175BK0110","0001175CHR070","0001175CHR080","0001175CHR090","0001175CHR100","0001175CHR110","0001176041070","0001176041080","0001176041090","0001176041100","0001176041110","0001176155070","0001176155080","0001176155090","0001176155100","0001176155110","0001176SGL070","0001176SGL080","0001176SGL090","0001176SGL100","0001176SGL110","0001195645300","0001195645310","0001195645320","0001195645330","0001195645340","0001195645350","0001195645360","0001200020350","0001200020360","0001200020370","0001200020380","0001200020390","0001200020400","0001216NE0000","0001217NE0000","0001223110000","00012231M0000"
		List<String> ojosAGuardar = new ArrayList<String>(Arrays.asList("A109","A110","A111","A112","A113","A114","A115","A116","A117","A118","A119","A120","A81","A82","A83","A84","A85","A86"/*,"A87","A88","A89","A90","A91","A92","A93","A94","A95","A96","A97","A98","A99","A121","A122","A123","A124","A125","A126","A127","A128","A129","A130","A131","A132","A133","A134","A135","A136","A137","A138","A139","A140","A141","A142","A143","A144","A145","A146","A147","A148","A149","A150","A151","A152","A153","A154","A155","A156","A157","A158","A159","A160","A161","A162","A163","A164","A165","A166","A167","A168","A169","A170","A171","A172","A173","A174","A175","A176","A177","A178","A179","A180","A181","A182","A183","A184","A185","A186","A187","A188","A189","A190","A191","A192","A193","A194","A195","A196","A197","A198","A199","A200","A201","A202","A203","A204","A205","A206","A207","A208","A209","A210","A211","A212","A213","A214","A215","A216","A217","A218","A219","A220","A221","A222","A223","A224","A225","A226","A227","A228","A229","A230","A231","A232","A233","A234","A235","A236","A237","A238","A239","A240","A241","A242","A243","A244","A245","A246","A247","A248","A249","A250","A251","A252","A253","A254","A255","A256","A257","A258","A259","A260","A261","A262","A263","A264","A265","A266","A267","A268","A269","A270","A271","A272","A273","A274","A275","A276","A277","A278","A279","A280","A281","A282","A283","A284","A285","A286","A287","A288","A289","A290","A291","A292","A293","A294","A295","A296","A297","A298"*/));
		List<String> codigosDestino = new ArrayList<String>(Arrays.asList("321","324")); //,"327","403","406","409","412","413","418","421","424","427","430","433","436"
		crearBultos(codigosArticulos, "A01", ojosAGuardar, 50, 15, 20, 2);
		             //cantidadBultos cantidadMaximaArticulosDiferentesEnBulto cantidadMaximaDeCadaArticuloEnBulto idEmpresa
		//crearReposiciones(codigosArticulos, codigosDestino, "Pruebas bultos cerrados", 1, 4, 2);
	}
	
	public static void crearBultos(List<String> codigosArticulos, String codigoInicialBultos, List<String> ojosAGuardar,
			 int cantidadBultosACrear, int cantidadMaximaArticulosDiferentesEnBulto, int cantidadMaximaDeCadaArticuloEnBulto, int idEmpresa) {
		
		int contadorCodigoBulto = 0;
		while (cantidadBultosACrear > 0) {
			String codigoBulto = codigoInicialBultos + contadorCodigoBulto;
			contadorCodigoBulto ++;
			int codigoOjoSeleccionado = (int) (Math.random() * (ojosAGuardar.size() - 0)) + 0;
			String codigoOjoSeleccionadoSTR = ojosAGuardar.get(codigoOjoSeleccionado);
			bulto b = new bulto(codigoBulto, "bultoPrueba", false, 2, 2, 2, 2.0, true, "2020-12-05", 0, codigoOjoSeleccionadoSTR, idEmpresa);
			b.Crear_Bulto(b.getIdEmpresa());
			
			int cantidadElementosEnBulto = (int) (Math.random() * (cantidadMaximaArticulosDiferentesEnBulto+1 - 1)) + 1; //poner +0 -0 + 0 para que no varie
			Hashtable<String, Integer> articuloCantidad = new Hashtable<String, Integer>();
			
			for (int i = 0; i < cantidadElementosEnBulto+1; i++) {
				int articuloSeleccionado = (int) (Math.random() * (codigosArticulos.size() - 0)) + 0;
				int cantidadArticuloSeleccionado = (int) (Math.random() * (cantidadMaximaDeCadaArticuloEnBulto - 1)) + 1;
				String codigoArticulo = codigosArticulos.get(articuloSeleccionado);
				if(!articuloCantidad.containsKey(codigoArticulo)) {
					articuloCantidad.put(codigoArticulo, cantidadArticuloSeleccionado);
					System.out.println("Bulto creado:" + codigoBulto + " articulo ingresado " + codigoArticulo);
				}
			}
			
			
			List<String> codigosA = Collections.list(articuloCantidad.keys());
			for (String codigo : codigosA) {
				bultoContenido bc = new bultoContenido(codigo, articuloCantidad.get(codigo), 0, 0);
				b.Agregar_A_Bulto_NO_persist(bc);
			}
			b.guardarDetalleBulto();
			b.Cerrar_Bulto(0, true);
			
			Logica l = new Logica();
			l.encuentraUpdateOjos(codigoOjoSeleccionadoSTR, codigoBulto, 1, false, 0, false, "ADD", 2);
			cantidadBultosACrear--;
		}
	}

	public static void crearReposiciones(List<String> codigosArticulos, List<String> codigosDestino, String justificacion, int cantidadReposicionesACrear, int cantidadArticulosPorRepo, int idEmpresa) {
		String consulta = "";
		int contadorIdSincro = 57910;
		int contadorSolicitud = 1;
		while(cantidadReposicionesACrear > 0) {
			consulta += "INSERT INTO reposicion_sincronizacion (id) VALUES ("+contadorIdSincro+"); \n ";
			List<String> articulosUsadosRepo = new ArrayList<String>();
			for (int i = 0; i < cantidadArticulosPorRepo; i++) {
				int indiceCodigoArticulo = (int) (Math.random() * (codigosArticulos.size() - 0)) + 0;
				String art = codigosArticulos.get(indiceCodigoArticulo);
				int indiceDestino = (int) (Math.random() * (codigosDestino.size() - 0)) + 0;
				String dest = codigosDestino.get(indiceDestino);
				while(articulosUsadosRepo.contains(art)) {
					indiceCodigoArticulo = (int) (Math.random() * (codigosArticulos.size() - 0)) + 0;
					art = codigosArticulos.get(indiceCodigoArticulo);
				}
				articulosUsadosRepo.add(art);
				consulta += "INSERT INTO reposicion_articulos (IdSincronizacion,idArticulo,Origen,Destino,Cantidad,Estado,Justificacion,Mayorista,idPicking,idUsuario,IdSolicitudTraslado,IdEmpresa,remision_bulto,idTipo) "
						+ "VALUES ("+contadorIdSincro+",'"+art+"',9000,"+dest+",5,1,'"+justificacion+"',1,0,1,"+contadorSolicitud+","+idEmpresa+",0,3); \n ";
			}
			articulosUsadosRepo = new ArrayList<String>();
			cantidadReposicionesACrear--;
			contadorIdSincro++;
			contadorSolicitud++;
		}
		System.out.println(consulta);
	}
}
